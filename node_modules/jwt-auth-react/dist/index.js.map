{"version":3,"file":"index.js","sources":["../src/AuthContext.js","../src/TokenObject.js","../src/AuthProvider.js","../src/isAuth.js","../src/PrivateRoute.js","../src/doAuth.js","../src/authHeader.js"],"sourcesContent":["/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport React from 'react'\r\n\r\n/**\r\n * Initialized Auth Context\r\n */\r\nconst Auth = React.createContext(null)\r\n\r\nexport const AuthContextProvider = Auth.Provider\r\nexport const AuthContext = Auth\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\n/**\r\n * Token Object Class\r\n */\r\nclass TokenObject {\r\n  /**\r\n   * @constructor\r\n   * @param tokenName - Name of the token\r\n   */\r\n  constructor(tokenName) {\r\n    this.tokenName = tokenName\r\n  }\r\n\r\n  /**\r\n   * Checks if the token is expired or not\r\n   * @returns {boolean} true: if the token is expired\r\n   */\r\n  isTokenExpire() {\r\n    if (this.isTokenExist()) {\r\n      const _e = JSON.parse(localStorage[this.tokenName]).expiresAt\r\n      return _e < new Date()\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @returns {boolean} true: if the token exists\r\n   */\r\n  isTokenExist() {\r\n    return localStorage[this.tokenName] !== undefined\r\n  }\r\n\r\n  /**\r\n   * Set Token\r\n   * @param value\r\n   * @param expiresAt\r\n   */\r\n  setToken(value, expiresAt, state) {\r\n    // {value: xxx, expiresAt: ttt, state: {}}\r\n    const json = { value: value, expiresAt: expiresAt, state: state }\r\n    localStorage[this.tokenName] = JSON.stringify(json)\r\n  }\r\n\r\n  /**\r\n   * Get the current token\r\n   * @returns {{authToken: token, expireAt: Date, state: Object}|{authToken: null, expireAt: null, state: null}}\r\n   */\r\n  getToken() {\r\n    if (this.isTokenExist()) {\r\n      if (!this.isTokenExpire()) {\r\n        const _t = JSON.parse(localStorage[this.tokenName])\r\n        const token = _t.value\r\n        const expiresAt = _t.expiresAt\r\n        const state = _t.state\r\n        return { authToken: token, expireAt: expiresAt, state: state }\r\n      } else {\r\n        return { authToken: null, expireAt: null, state: null }\r\n      }\r\n    } else {\r\n      return { authToken: null, expireAt: null, state: null }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove the Token\r\n   */\r\n  removeToken() {\r\n    localStorage.removeItem(this.tokenName)\r\n  }\r\n}\r\n\r\nexport default TokenObject\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { AuthContextProvider } from './AuthContext'\r\nimport TokenObject from './TokenObject'\r\n\r\n/**\r\n * AuthProvider, Context provider that passes the auth down to the components\r\n * @param cookieName - Name of the auth Cookie. Default: '_authUser'\r\n * @param children - React.Component | React.FunctionalComponent\r\n * @constructor\r\n */\r\nconst AuthProvider = ({ cookieName, children }) => {\r\n  const JwtToken = new TokenObject(cookieName)\r\n\r\n  const [authObject, setAuthObject] = useState(JwtToken.getToken())\r\n  useEffect(() => {\r\n    if (\r\n      authObject.authToken === undefined ||\r\n      authObject.authToken === null ||\r\n      authObject.expireAt === null\r\n    ) {\r\n      JwtToken.removeToken()\r\n    } else {\r\n      JwtToken.setToken(authObject.authToken, authObject.expireAt, authObject.state)\r\n    }\r\n  }, [authObject])\r\n\r\n  return (\r\n    <AuthContextProvider\r\n      value={{ authObject: authObject, setAuthToken: setAuthObject }}\r\n    >\r\n      {children}\r\n    </AuthContextProvider>\r\n  )\r\n}\r\n\r\nAuthProvider.defaultProps = {\r\n  cookieName: `_authUser`\r\n}\r\n\r\nexport default AuthProvider\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport { useContext } from 'react'\r\nimport { AuthContext } from './AuthContext'\r\n\r\n/**\r\n * Checks if the USER is logged in or not\r\n * @returns {{auth: boolean, authToken: string | null}} AuthObject\r\n */\r\n\r\nconst isAuth = () => {\r\n  const value = useContext(AuthContext)\r\n  if (value?.authObject.authToken && value?.authObject.expireAt) {\r\n    if (value.authObject.expireAt < new Date()) {\r\n      return { auth: true, authToken: value.authObject.authToken }\r\n    } else {\r\n      value.setAuthToken({ authToken: null, expireAt: null, state: null })\r\n      return { auth: false, authToken: null }\r\n    }\r\n  } else {\r\n    return { auth: false, authToken: null }\r\n  }\r\n}\r\n\r\nexport default isAuth\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport React, { useContext } from 'react'\r\nimport { Route, Redirect } from 'react-router-dom'\r\nimport { AuthContext } from './AuthContext'\r\n\r\n/**\r\n *\r\n * @param component - Component to Route\r\n * @param loginPath - Login Page path\r\n * @param path - Path of the Coponent\r\n * @param rest - Other Things\r\n */\r\nconst PrivateRoute = ({ component: Component, loginPath: loginPath, ...rest }) => {\r\n  const _authContext = useContext(AuthContext)\r\n  \r\n  const isAuth = () => {\r\n    if (_authContext?.authObject.authToken && _authContext?.authObject.expireAt) {\r\n      if (_authContext.authObject.expireAt < new Date()) {\r\n        return { auth: true, authToken: _authContext.authObject.authToken }\r\n      } else {\r\n        _authContext.setAuthToken({ authToken: null, expireAt: null, state: null })\r\n        return { auth: false, authToken: null }\r\n      }\r\n    } else {\r\n      return { auth: false, authToken: null }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) =>\r\n        isAuth().auth ? <Component {...props} /> : <Redirect to={loginPath} />\r\n      }\r\n    />\r\n  )\r\n}\r\n\r\nexport default PrivateRoute\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport { useContext } from 'react'\r\nimport { AuthContext } from './AuthContext'\r\n\r\n/**\r\n * Auth Login function\r\n * @param {string} token - Token from the backend server\r\n * @param {number} expiresIn - Time takes to expires a token in minutes\r\n * @param {Object} state - User state\r\n * @returns {boolean} - success status\r\n */\r\nexport const loginAuth = (token, expiresIn, state) => {\r\n  const expTime = new Date(new Date().getTime() + expiresIn * 60 * 1000)\r\n\r\n  try {\r\n    const c = useContext(AuthContext)\r\n    c.setAuthToken({ authToken: token, expireAt: expTime, state: state })\r\n    return true\r\n  } catch (e) {\r\n    console.error(e)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Auth Logout Function\r\n * @returns {boolean} - success status\r\n */\r\nexport const logoutAuth = () => {\r\n  try {\r\n    const c = useContext(AuthContext)\r\n    if (c?.authObject.authToken) {\r\n      c.setAuthToken({ authToken: null, expireAt: null, state: null })\r\n      return true\r\n    } else {\r\n      return false\r\n    }\r\n  } catch (e) {\r\n    console.error(e)\r\n    return false\r\n  }\r\n}\r\n","/*\r\n * Copyright 2020. Arkadip Bhattacharya\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *  you may not use this file except in compliance with the License.\r\n *  You may obtain a copy of the License at\r\n *\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  Unless required by applicable law or agreed to in writing, software\r\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n */\r\n\r\nimport { useContext } from 'react'\r\nimport { AuthContext } from './AuthContext'\r\n\r\nconst authHeader = () => {\r\n  const c = useContext(AuthContext)\r\n  if (c.authObject.authToken) {\r\n    return `Bearer ${c.authObject.authToken}`\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nexport default authHeader\r\n"],"names":["Auth","React","createContext","AuthContextProvider","Provider","AuthContext","TokenObject","tokenName","isTokenExpire","isTokenExist","_e","JSON","parse","localStorage","expiresAt","Date","undefined","setToken","value","state","json","stringify","getToken","_t","token","authToken","expireAt","removeToken","removeItem","AuthProvider","cookieName","children","JwtToken","useState","authObject","setAuthObject","useEffect","setAuthToken","defaultProps","isAuth","useContext","auth","PrivateRoute","Component","component","loginPath","rest","_authContext","Route","props","Redirect","loginAuth","expiresIn","expTime","getTime","c","e","console","error","logoutAuth","authHeader"],"mappings":";;;;;;AAqBA,IAAMA,IAAI,GAAGC,cAAK,CAACC,aAAN,CAAoB,IAApB,CAAb;AAEO,IAAMC,mBAAmB,GAAGH,IAAI,CAACI,QAAjC;AACA,IAAMC,WAAW,GAAGL,IAApB;;ICLDM;AAKJ,uBAAYC,SAAZ,EAAuB;AACrB,SAAKA,SAAL,GAAiBA,SAAjB;AACD;;;;SAMDC,gBAAA,yBAAgB;AACd,QAAI,KAAKC,YAAL,EAAJ,EAAyB;AACvB,UAAMC,EAAE,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAAC,KAAKN,SAAN,CAAvB,EAAyCO,SAApD;AACA,aAAOJ,EAAE,GAAG,IAAIK,IAAJ,EAAZ;AACD,KAHD,MAGO;AACL,aAAO,IAAP;AACD;AACF;;SAKDN,eAAA,wBAAe;AACb,WAAOI,YAAY,CAAC,KAAKN,SAAN,CAAZ,KAAiCS,SAAxC;AACD;;SAODC,WAAA,kBAASC,KAAT,EAAgBJ,SAAhB,EAA2BK,KAA3B,EAAkC;AAEhC,QAAMC,IAAI,GAAG;AAAEF,MAAAA,KAAK,EAAEA,KAAT;AAAgBJ,MAAAA,SAAS,EAAEA,SAA3B;AAAsCK,MAAAA,KAAK,EAAEA;AAA7C,KAAb;AACAN,IAAAA,YAAY,CAAC,KAAKN,SAAN,CAAZ,GAA+BI,IAAI,CAACU,SAAL,CAAeD,IAAf,CAA/B;AACD;;SAMDE,WAAA,oBAAW;AACT,QAAI,KAAKb,YAAL,EAAJ,EAAyB;AACvB,UAAI,CAAC,KAAKD,aAAL,EAAL,EAA2B;AACzB,YAAMe,EAAE,GAAGZ,IAAI,CAACC,KAAL,CAAWC,YAAY,CAAC,KAAKN,SAAN,CAAvB,CAAX;;AACA,YAAMiB,KAAK,GAAGD,EAAE,CAACL,KAAjB;AACA,YAAMJ,SAAS,GAAGS,EAAE,CAACT,SAArB;AACA,YAAMK,KAAK,GAAGI,EAAE,CAACJ,KAAjB;AACA,eAAO;AAAEM,UAAAA,SAAS,EAAED,KAAb;AAAoBE,UAAAA,QAAQ,EAAEZ,SAA9B;AAAyCK,UAAAA,KAAK,EAAEA;AAAhD,SAAP;AACD,OAND,MAMO;AACL,eAAO;AAAEM,UAAAA,SAAS,EAAE,IAAb;AAAmBC,UAAAA,QAAQ,EAAE,IAA7B;AAAmCP,UAAAA,KAAK,EAAE;AAA1C,SAAP;AACD;AACF,KAVD,MAUO;AACL,aAAO;AAAEM,QAAAA,SAAS,EAAE,IAAb;AAAmBC,QAAAA,QAAQ,EAAE,IAA7B;AAAmCP,QAAAA,KAAK,EAAE;AAA1C,OAAP;AACD;AACF;;SAKDQ,cAAA,uBAAc;AACZd,IAAAA,YAAY,CAACe,UAAb,CAAwB,KAAKrB,SAA7B;AACD;;;;;AC1DH,IAAMsB,YAAY,GAAG,SAAfA,YAAe,OAA8B;AAAA,MAA3BC,UAA2B,QAA3BA,UAA2B;AAAA,MAAfC,QAAe,QAAfA,QAAe;AACjD,MAAMC,QAAQ,GAAG,IAAI1B,WAAJ,CAAgBwB,UAAhB,CAAjB;;AADiD,kBAGbG,cAAQ,CAACD,QAAQ,CAACV,QAAT,EAAD,CAHK;AAAA,MAG1CY,UAH0C;AAAA,MAG9BC,aAH8B;;AAIjDC,EAAAA,eAAS,CAAC,YAAM;AACd,QACEF,UAAU,CAACT,SAAX,KAAyBT,SAAzB,IACAkB,UAAU,CAACT,SAAX,KAAyB,IADzB,IAEAS,UAAU,CAACR,QAAX,KAAwB,IAH1B,EAIE;AACAM,MAAAA,QAAQ,CAACL,WAAT;AACD,KAND,MAMO;AACLK,MAAAA,QAAQ,CAACf,QAAT,CAAkBiB,UAAU,CAACT,SAA7B,EAAwCS,UAAU,CAACR,QAAnD,EAA6DQ,UAAU,CAACf,KAAxE;AACD;AACF,GAVQ,EAUN,CAACe,UAAD,CAVM,CAAT;AAYA,sBACEjC,6BAAC,mBAAD;AACE,IAAA,KAAK,EAAE;AAAEiC,MAAAA,UAAU,EAAEA,UAAd;AAA0BG,MAAAA,YAAY,EAAEF;AAAxC;AADT,KAGGJ,QAHH,CADF;AAOD,CAvBD;;AAyBAF,YAAY,CAACS,YAAb,GAA4B;AAC1BR,EAAAA,UAAU;AADgB,CAA5B;;AC3BA,IAAMS,MAAM,GAAG,SAATA,MAAS,GAAM;AACnB,MAAMrB,KAAK,GAAGsB,gBAAU,CAACnC,WAAD,CAAxB;;AACA,MAAI,CAAAa,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEgB,UAAP,CAAkBT,SAAlB,MAA+BP,KAA/B,aAA+BA,KAA/B,uBAA+BA,KAAK,CAAEgB,UAAP,CAAkBR,QAAjD,CAAJ,EAA+D;AAC7D,QAAIR,KAAK,CAACgB,UAAN,CAAiBR,QAAjB,GAA4B,IAAIX,IAAJ,EAAhC,EAA4C;AAC1C,aAAO;AAAE0B,QAAAA,IAAI,EAAE,IAAR;AAAchB,QAAAA,SAAS,EAAEP,KAAK,CAACgB,UAAN,CAAiBT;AAA1C,OAAP;AACD,KAFD,MAEO;AACLP,MAAAA,KAAK,CAACmB,YAAN,CAAmB;AAAEZ,QAAAA,SAAS,EAAE,IAAb;AAAmBC,QAAAA,QAAQ,EAAE,IAA7B;AAAmCP,QAAAA,KAAK,EAAE;AAA1C,OAAnB;AACA,aAAO;AAAEsB,QAAAA,IAAI,EAAE,KAAR;AAAehB,QAAAA,SAAS,EAAE;AAA1B,OAAP;AACD;AACF,GAPD,MAOO;AACL,WAAO;AAAEgB,MAAAA,IAAI,EAAE,KAAR;AAAehB,MAAAA,SAAS,EAAE;AAA1B,KAAP;AACD;AACF,CAZD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACGA,IAAMiB,YAAY,GAAG,SAAfA,YAAe,OAA6D;AAAA,MAA/CC,SAA+C,QAA1DC,SAA0D;AAAA,MAAzBC,SAAyB,QAApCA,SAAoC;AAAA,MAAXC,IAAW;;AAChF,MAAMC,YAAY,GAAGP,gBAAU,CAACnC,WAAD,CAA/B;;AAEA,MAAMkC,MAAM,GAAG,SAATA,MAAS,GAAM;AACnB,QAAI,CAAAQ,YAAY,SAAZ,IAAAA,YAAY,WAAZ,YAAAA,YAAY,CAAEb,UAAd,CAAyBT,SAAzB,MAAsCsB,YAAtC,aAAsCA,YAAtC,uBAAsCA,YAAY,CAAEb,UAAd,CAAyBR,QAA/D,CAAJ,EAA6E;AAC3E,UAAIqB,YAAY,CAACb,UAAb,CAAwBR,QAAxB,GAAmC,IAAIX,IAAJ,EAAvC,EAAmD;AACjD,eAAO;AAAE0B,UAAAA,IAAI,EAAE,IAAR;AAAchB,UAAAA,SAAS,EAAEsB,YAAY,CAACb,UAAb,CAAwBT;AAAjD,SAAP;AACD,OAFD,MAEO;AACLsB,QAAAA,YAAY,CAACV,YAAb,CAA0B;AAAEZ,UAAAA,SAAS,EAAE,IAAb;AAAmBC,UAAAA,QAAQ,EAAE,IAA7B;AAAmCP,UAAAA,KAAK,EAAE;AAA1C,SAA1B;;AACA,eAAO;AAAEsB,UAAAA,IAAI,EAAE,KAAR;AAAehB,UAAAA,SAAS,EAAE;AAA1B,SAAP;AACD;AACF,KAPD,MAOO;AACL,aAAO;AAAEgB,QAAAA,IAAI,EAAE,KAAR;AAAehB,QAAAA,SAAS,EAAE;AAA1B,OAAP;AACD;AACF,GAXD;;AAaA,sBACExB,6BAAC+C,oBAAD,eACMF,IADN;AAEE,IAAA,MAAM,EAAE,gBAACG,KAAD;AAAA,aACNV,MAAM,GAAGE,IAAT,gBAAgBxC,6BAAC,SAAD,EAAegD,KAAf,CAAhB,gBAA2ChD,6BAACiD,uBAAD;AAAU,QAAA,EAAE,EAAEL;AAAd,QADrC;AAAA;AAFV,KADF;AAQD,CAxBD;;ICDaM,SAAS,GAAG,SAAZA,SAAY,CAAC3B,KAAD,EAAQ4B,SAAR,EAAmBjC,KAAnB,EAA6B;AACpD,MAAMkC,OAAO,GAAG,IAAItC,IAAJ,CAAS,IAAIA,IAAJ,GAAWuC,OAAX,KAAuBF,SAAS,GAAG,EAAZ,GAAiB,IAAjD,CAAhB;;AAEA,MAAI;AACF,QAAMG,CAAC,GAAGf,gBAAU,CAACnC,WAAD,CAApB;AACAkD,IAAAA,CAAC,CAAClB,YAAF,CAAe;AAAEZ,MAAAA,SAAS,EAAED,KAAb;AAAoBE,MAAAA,QAAQ,EAAE2B,OAA9B;AAAuClC,MAAAA,KAAK,EAAEA;AAA9C,KAAf;AACA,WAAO,IAAP;AACD,GAJD,CAIE,OAAOqC,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACA,WAAO,KAAP;AACD;AACF,CAXM;AAiBP,IAAaG,UAAU,GAAG,SAAbA,UAAa,GAAM;AAC9B,MAAI;AACF,QAAMJ,CAAC,GAAGf,gBAAU,CAACnC,WAAD,CAApB;;AACA,QAAIkD,CAAJ,aAAIA,CAAJ,uBAAIA,CAAC,CAAErB,UAAH,CAAcT,SAAlB,EAA6B;AAC3B8B,MAAAA,CAAC,CAAClB,YAAF,CAAe;AAAEZ,QAAAA,SAAS,EAAE,IAAb;AAAmBC,QAAAA,QAAQ,EAAE,IAA7B;AAAmCP,QAAAA,KAAK,EAAE;AAA1C,OAAf;AACA,aAAO,IAAP;AACD,KAHD,MAGO;AACL,aAAO,KAAP;AACD;AACF,GARD,CAQE,OAAOqC,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACA,WAAO,KAAP;AACD;AACF,CAbM;;ACxBP,IAAMI,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,MAAML,CAAC,GAAGf,gBAAU,CAACnC,WAAD,CAApB;;AACA,MAAIkD,CAAC,CAACrB,UAAF,CAAaT,SAAjB,EAA4B;AAC1B,uBAAiB8B,CAAC,CAACrB,UAAF,CAAaT,SAA9B;AACD,GAFD,MAEO;AACL,WAAO,IAAP;AACD;AACF,CAPD;;;;;;;;;"}